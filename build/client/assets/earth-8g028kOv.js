import{r as l,j as le}from"./jsx-runtime-CbkKSL4Y.js";import{u as lt,e as Je,d as ut,c as it,b as dt,m as pt,L as mt}from"./heading-D8Tt-9AR.js";import{S as ht}from"./meta-CmI2pxCI.js";import{t as ft}from"./config-Bk0ALTY1.js";import{u as gt}from"./image-m5-ZYNrw.js";import{u as bt}from"./useWindowSize-MDlHk0QV.js";import{R as yt,e as Et,E as wt,f as J,Q as et,P as De,O as He,g as tt,V as ce,h as Pe,T as Re,i as _t,H as Se,F as Ge,j as Ye,k as ke,l as Tt,C as Pt,m as Rt,n as St,W as Mt,o as nt,p as xt,S as vt,q as At,s as Lt,A as jt,D as Dt,r as kt,c as Ot,d as Ct,u as Ve,v as It,w as Nt,t as Ft,x as zt,y as Ht,z as Yt,B as Bt,G as Gt}from"./throttle-C73Cq3op.js";import{c as ot}from"./clamp-e7DugykH.js";import{u as Te}from"./use-spring-C8-hVHuT.js";import"./components-BUNpIsrb.js";import"./theme-provider-DjYxPUYU.js";const Ut="/assets/earth-DvZudj9K.glb",Vt="/assets/milkyway-nx-Ds_hwpSC.hdr",Zt="/assets/milkyway-ny-BqhFvupA.hdr",Xt="/assets/milkyway-nz-D6l6T-pv.hdr",Wt="/assets/milkyway-px-BjIdbMt0.hdr",qt="/assets/milkyway-py-BD6pEbZF.hdr",Kt="/assets/milkyway-pz-Bx3WFS88.hdr",$t="/assets/milkyway-Vkpv7LbT.jpg";var Qt=Object.defineProperty,Jt=(p,r,E)=>r in p?Qt(p,r,{enumerable:!0,configurable:!0,writable:!0,value:E}):p[r]=E,s=(p,r,E)=>(Jt(p,typeof r!="symbol"?r+"":r,E),E);const Be=new yt,at=new Et,en=Math.cos(70*(Math.PI/180)),rt=(p,r)=>(p%r+r)%r;class tn extends wt{constructor(r,E){super(),s(this,"object"),s(this,"domElement"),s(this,"enabled",!0),s(this,"target",new J),s(this,"minDistance",0),s(this,"maxDistance",1/0),s(this,"minZoom",0),s(this,"maxZoom",1/0),s(this,"minPolarAngle",0),s(this,"maxPolarAngle",Math.PI),s(this,"minAzimuthAngle",-1/0),s(this,"maxAzimuthAngle",1/0),s(this,"enableDamping",!1),s(this,"dampingFactor",.05),s(this,"enableZoom",!0),s(this,"zoomSpeed",1),s(this,"enableRotate",!0),s(this,"rotateSpeed",1),s(this,"enablePan",!0),s(this,"panSpeed",1),s(this,"screenSpacePanning",!0),s(this,"keyPanSpeed",7),s(this,"zoomToCursor",!1),s(this,"autoRotate",!1),s(this,"autoRotateSpeed",2),s(this,"reverseOrbit",!1),s(this,"reverseHorizontalOrbit",!1),s(this,"reverseVerticalOrbit",!1),s(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),s(this,"mouseButtons",{LEFT:Pe.ROTATE,MIDDLE:Pe.DOLLY,RIGHT:Pe.PAN}),s(this,"touches",{ONE:Re.ROTATE,TWO:Re.DOLLY_PAN}),s(this,"target0"),s(this,"position0"),s(this,"zoom0"),s(this,"_domElementKeyEvents",null),s(this,"getPolarAngle"),s(this,"getAzimuthalAngle"),s(this,"setPolarAngle"),s(this,"setAzimuthalAngle"),s(this,"getDistance"),s(this,"listenToKeyEvents"),s(this,"stopListenToKeyEvents"),s(this,"saveState"),s(this,"reset"),s(this,"update"),s(this,"connect"),s(this,"dispose"),this.object=r,this.domElement=E,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=t=>{let n=rt(t,2*Math.PI),i=_.phi;i<0&&(i+=2*Math.PI),n<0&&(n+=2*Math.PI);let S=Math.abs(n-i);2*Math.PI-S<S&&(n<i?n+=2*Math.PI:i+=2*Math.PI),k.phi=n-i,e.update()},this.setAzimuthalAngle=t=>{let n=rt(t,2*Math.PI),i=_.theta;i<0&&(i+=2*Math.PI),n<0&&(n+=2*Math.PI);let S=Math.abs(n-i);2*Math.PI-S<S&&(n<i?n+=2*Math.PI:i+=2*Math.PI),k.theta=n-i,e.update()},this.getDistance=()=>e.object.position.distanceTo(e.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",pe),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",pe),this._domElementKeyEvents=null},this.saveState=()=>{e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=()=>{e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(Q),e.update(),w=d.NONE},this.update=(()=>{const t=new J,n=new J(0,1,0),i=new et().setFromUnitVectors(r.up,n),S=i.clone().invert(),B=new J,me=new et,Ee=2*Math.PI;return function(){const Qe=e.object.position;i.setFromUnitVectors(r.up,n),S.copy(i).invert(),t.copy(Qe).sub(e.target),t.applyQuaternion(i),_.setFromVector3(t),e.autoRotate&&w===d.NONE&&u(L()),e.enableDamping?(_.theta+=k.theta*e.dampingFactor,_.phi+=k.phi*e.dampingFactor):(_.theta+=k.theta,_.phi+=k.phi);let he=e.minAzimuthAngle,fe=e.maxAzimuthAngle;isFinite(he)&&isFinite(fe)&&(he<-Math.PI?he+=Ee:he>Math.PI&&(he-=Ee),fe<-Math.PI?fe+=Ee:fe>Math.PI&&(fe-=Ee),he<=fe?_.theta=Math.max(he,Math.min(fe,_.theta)):_.theta=_.theta>(he+fe)/2?Math.max(he,_.theta):Math.min(fe,_.theta)),_.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,_.phi)),_.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(re,e.dampingFactor):e.target.add(re),e.zoomToCursor&&h||e.object.isOrthographicCamera?_.radius=O(_.radius):_.radius=O(_.radius*G),t.setFromSpherical(_),t.applyQuaternion(S),Qe.copy(e.target).add(t),e.object.matrixAutoUpdate||e.object.updateMatrix(),e.object.lookAt(e.target),e.enableDamping===!0?(k.theta*=1-e.dampingFactor,k.phi*=1-e.dampingFactor,re.multiplyScalar(1-e.dampingFactor)):(k.set(0,0,0),re.set(0,0,0));let Ae=!1;if(e.zoomToCursor&&h){let Le=null;if(e.object instanceof De&&e.object.isPerspectiveCamera){const je=t.length();Le=O(je*G);const ze=je-Le;e.object.position.addScaledVector(te,ze),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const je=new J(o.x,o.y,0);je.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/G)),e.object.updateProjectionMatrix(),Ae=!0;const ze=new J(o.x,o.y,0);ze.unproject(e.object),e.object.position.sub(ze).add(je),e.object.updateMatrixWorld(),Le=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;Le!==null&&(e.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(Le).add(e.object.position):(Be.origin.copy(e.object.position),Be.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(Be.direction))<en?r.lookAt(e.target):(at.setFromNormalAndCoplanarPoint(e.object.up,e.target),Be.intersectPlane(at,e.target))))}else e.object instanceof He&&e.object.isOrthographicCamera&&(Ae=G!==1,Ae&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/G)),e.object.updateProjectionMatrix()));return G=1,h=!1,Ae||B.distanceToSquared(e.object.position)>V||8*(1-me.dot(e.object.quaternion))>V?(e.dispatchEvent(Q),B.copy(e.object.position),me.copy(e.object.quaternion),Ae=!1,!0):!1}})(),this.connect=t=>{e.domElement=t,e.domElement.style.touchAction="none",e.domElement.addEventListener("contextmenu",ve),e.domElement.addEventListener("pointerdown",z),e.domElement.addEventListener("pointercancel",y),e.domElement.addEventListener("wheel",$)},this.dispose=()=>{var t,n,i,S,B,me;e.domElement&&(e.domElement.style.touchAction="auto"),(t=e.domElement)==null||t.removeEventListener("contextmenu",ve),(n=e.domElement)==null||n.removeEventListener("pointerdown",z),(i=e.domElement)==null||i.removeEventListener("pointercancel",y),(S=e.domElement)==null||S.removeEventListener("wheel",$),(B=e.domElement)==null||B.ownerDocument.removeEventListener("pointermove",U),(me=e.domElement)==null||me.ownerDocument.removeEventListener("pointerup",y),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",pe)};const e=this,Q={type:"change"},P={type:"start"},c={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let w=d.NONE;const V=1e-6,_=new tt,k=new tt;let G=1;const re=new J,M=new ce,D=new ce,W=new ce,H=new ce,Y=new ce,C=new ce,f=new ce,ee=new ce,se=new ce,te=new J,o=new ce;let h=!1;const a=[],g={};function L(){return 2*Math.PI/60/60*e.autoRotateSpeed}function x(){return Math.pow(.95,e.zoomSpeed)}function u(t){e.reverseOrbit||e.reverseHorizontalOrbit?k.theta+=t:k.theta-=t}function b(t){e.reverseOrbit||e.reverseVerticalOrbit?k.phi+=t:k.phi-=t}const T=(()=>{const t=new J;return function(i,S){t.setFromMatrixColumn(S,0),t.multiplyScalar(-i),re.add(t)}})(),ie=(()=>{const t=new J;return function(i,S){e.screenSpacePanning===!0?t.setFromMatrixColumn(S,1):(t.setFromMatrixColumn(S,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(i),re.add(t)}})(),ne=(()=>{const t=new J;return function(i,S){const B=e.domElement;if(B&&e.object instanceof De&&e.object.isPerspectiveCamera){const me=e.object.position;t.copy(me).sub(e.target);let Ee=t.length();Ee*=Math.tan(e.object.fov/2*Math.PI/180),T(2*i*Ee/B.clientHeight,e.object.matrix),ie(2*S*Ee/B.clientHeight,e.object.matrix)}else B&&e.object instanceof He&&e.object.isOrthographicCamera?(T(i*(e.object.right-e.object.left)/e.object.zoom/B.clientWidth,e.object.matrix),ie(S*(e.object.top-e.object.bottom)/e.object.zoom/B.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function q(t){e.object instanceof De&&e.object.isPerspectiveCamera||e.object instanceof He&&e.object.isOrthographicCamera?G/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Z(t){e.object instanceof De&&e.object.isPerspectiveCamera||e.object instanceof He&&e.object.isOrthographicCamera?G*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ue(t){if(!e.zoomToCursor||!e.domElement)return;h=!0;const n=e.domElement.getBoundingClientRect(),i=t.clientX-n.left,S=t.clientY-n.top,B=n.width,me=n.height;o.x=i/B*2-1,o.y=-(S/me)*2+1,te.set(o.x,o.y,1).unproject(e.object).sub(e.object.position).normalize()}function O(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function I(t){M.set(t.clientX,t.clientY)}function oe(t){ue(t),f.set(t.clientX,t.clientY)}function be(t){H.set(t.clientX,t.clientY)}function we(t){D.set(t.clientX,t.clientY),W.subVectors(D,M).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(u(2*Math.PI*W.x/n.clientHeight),b(2*Math.PI*W.y/n.clientHeight)),M.copy(D),e.update()}function _e(t){ee.set(t.clientX,t.clientY),se.subVectors(ee,f),se.y>0?q(x()):se.y<0&&Z(x()),f.copy(ee),e.update()}function ye(t){Y.set(t.clientX,t.clientY),C.subVectors(Y,H).multiplyScalar(e.panSpeed),ne(C.x,C.y),H.copy(Y),e.update()}function Me(t){ue(t),t.deltaY<0?Z(x()):t.deltaY>0&&q(x()),e.update()}function Oe(t){let n=!1;switch(t.code){case e.keys.UP:ne(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:ne(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:ne(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:ne(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function Ce(){if(a.length==1)M.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),n=.5*(a[0].pageY+a[1].pageY);M.set(t,n)}}function Ie(){if(a.length==1)H.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),n=.5*(a[0].pageY+a[1].pageY);H.set(t,n)}}function R(){const t=a[0].pageX-a[1].pageX,n=a[0].pageY-a[1].pageY,i=Math.sqrt(t*t+n*n);f.set(0,i)}function v(){e.enableZoom&&R(),e.enablePan&&Ie()}function j(){e.enableZoom&&R(),e.enableRotate&&Ce()}function X(t){if(a.length==1)D.set(t.pageX,t.pageY);else{const i=Ue(t),S=.5*(t.pageX+i.x),B=.5*(t.pageY+i.y);D.set(S,B)}W.subVectors(D,M).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(u(2*Math.PI*W.x/n.clientHeight),b(2*Math.PI*W.y/n.clientHeight)),M.copy(D)}function K(t){if(a.length==1)Y.set(t.pageX,t.pageY);else{const n=Ue(t),i=.5*(t.pageX+n.x),S=.5*(t.pageY+n.y);Y.set(i,S)}C.subVectors(Y,H).multiplyScalar(e.panSpeed),ne(C.x,C.y),H.copy(Y)}function F(t){const n=Ue(t),i=t.pageX-n.x,S=t.pageY-n.y,B=Math.sqrt(i*i+S*S);ee.set(0,B),se.set(0,Math.pow(ee.y/f.y,e.zoomSpeed)),q(se.y),f.copy(ee)}function A(t){e.enableZoom&&F(t),e.enablePan&&K(t)}function de(t){e.enableZoom&&F(t),e.enableRotate&&X(t)}function z(t){var n,i;e.enabled!==!1&&(a.length===0&&((n=e.domElement)==null||n.ownerDocument.addEventListener("pointermove",U),(i=e.domElement)==null||i.ownerDocument.addEventListener("pointerup",y)),Ne(t),t.pointerType==="touch"?ae(t):m(t))}function U(t){e.enabled!==!1&&(t.pointerType==="touch"?xe(t):N(t))}function y(t){var n,i,S;Fe(t),a.length===0&&((n=e.domElement)==null||n.releasePointerCapture(t.pointerId),(i=e.domElement)==null||i.ownerDocument.removeEventListener("pointermove",U),(S=e.domElement)==null||S.ownerDocument.removeEventListener("pointerup",y)),e.dispatchEvent(c),w=d.NONE}function m(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case Pe.DOLLY:if(e.enableZoom===!1)return;oe(t),w=d.DOLLY;break;case Pe.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;be(t),w=d.PAN}else{if(e.enableRotate===!1)return;I(t),w=d.ROTATE}break;case Pe.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;I(t),w=d.ROTATE}else{if(e.enablePan===!1)return;be(t),w=d.PAN}break;default:w=d.NONE}w!==d.NONE&&e.dispatchEvent(P)}function N(t){if(e.enabled!==!1)switch(w){case d.ROTATE:if(e.enableRotate===!1)return;we(t);break;case d.DOLLY:if(e.enableZoom===!1)return;_e(t);break;case d.PAN:if(e.enablePan===!1)return;ye(t);break}}function $(t){e.enabled===!1||e.enableZoom===!1||w!==d.NONE&&w!==d.ROTATE||(t.preventDefault(),e.dispatchEvent(P),Me(t),e.dispatchEvent(c))}function pe(t){e.enabled===!1||e.enablePan===!1||Oe(t)}function ae(t){switch($e(t),a.length){case 1:switch(e.touches.ONE){case Re.ROTATE:if(e.enableRotate===!1)return;Ce(),w=d.TOUCH_ROTATE;break;case Re.PAN:if(e.enablePan===!1)return;Ie(),w=d.TOUCH_PAN;break;default:w=d.NONE}break;case 2:switch(e.touches.TWO){case Re.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;v(),w=d.TOUCH_DOLLY_PAN;break;case Re.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;j(),w=d.TOUCH_DOLLY_ROTATE;break;default:w=d.NONE}break;default:w=d.NONE}w!==d.NONE&&e.dispatchEvent(P)}function xe(t){switch($e(t),w){case d.TOUCH_ROTATE:if(e.enableRotate===!1)return;X(t),e.update();break;case d.TOUCH_PAN:if(e.enablePan===!1)return;K(t),e.update();break;case d.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;A(t),e.update();break;case d.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;de(t),e.update();break;default:w=d.NONE}}function ve(t){e.enabled!==!1&&t.preventDefault()}function Ne(t){a.push(t)}function Fe(t){delete g[t.pointerId];for(let n=0;n<a.length;n++)if(a[n].pointerId==t.pointerId){a.splice(n,1);return}}function $e(t){let n=g[t.pointerId];n===void 0&&(n=new ce,g[t.pointerId]=n),n.set(t.pageX,t.pageY)}function Ue(t){const n=t.pointerId===a[0].pointerId?a[1]:a[0];return g[n.pointerId]}E!==void 0&&this.connect(E),this.update()}}class nn extends _t{constructor(r){super(r),this.type=Se}parse(r){const c=function(o,h){switch(o){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(h||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(h||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(h||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(h||""))}},_=`
`,k=function(o,h,a){h=h||1024;let L=o.pos,x=-1,u=0,b="",T=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));for(;0>(x=T.indexOf(_))&&u<h&&L<o.byteLength;)b+=T,u+=T.length,L+=128,T+=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));return-1<x?(o.pos+=u+x+1,b+T.slice(0,x)):!1},G=function(o){const h=/^#\?(\S+)/,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,g=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*FORMAT=(\S+)\s*$/,x=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let b,T;for((o.pos>=o.byteLength||!(b=k(o)))&&c(1,"no header found"),(T=b.match(h))||c(3,"bad initial token"),u.valid|=1,u.programtype=T[1],u.string+=b+`
`;b=k(o),b!==!1;){if(u.string+=b+`
`,b.charAt(0)==="#"){u.comments+=b+`
`;continue}if((T=b.match(a))&&(u.gamma=parseFloat(T[1])),(T=b.match(g))&&(u.exposure=parseFloat(T[1])),(T=b.match(L))&&(u.valid|=2,u.format=T[1]),(T=b.match(x))&&(u.valid|=4,u.height=parseInt(T[1],10),u.width=parseInt(T[2],10)),u.valid&2&&u.valid&4)break}return u.valid&2||c(3,"missing format specifier"),u.valid&4||c(3,"missing image size specifier"),u},re=function(o,h,a){const g=h;if(g<8||g>32767||o[0]!==2||o[1]!==2||o[2]&128)return new Uint8Array(o);g!==(o[2]<<8|o[3])&&c(3,"wrong scanline width");const L=new Uint8Array(4*h*a);L.length||c(4,"unable to allocate buffer space");let x=0,u=0;const b=4*g,T=new Uint8Array(4),ie=new Uint8Array(b);let ne=a;for(;ne>0&&u<o.byteLength;){u+4>o.byteLength&&c(1),T[0]=o[u++],T[1]=o[u++],T[2]=o[u++],T[3]=o[u++],(T[0]!=2||T[1]!=2||(T[2]<<8|T[3])!=g)&&c(3,"bad rgbe scanline format");let q=0,Z;for(;q<b&&u<o.byteLength;){Z=o[u++];const O=Z>128;if(O&&(Z-=128),(Z===0||q+Z>b)&&c(3,"bad scanline data"),O){const I=o[u++];for(let oe=0;oe<Z;oe++)ie[q++]=I}else ie.set(o.subarray(u,u+Z),q),q+=Z,u+=Z}const ue=g;for(let O=0;O<ue;O++){let I=0;L[x]=ie[O+I],I+=g,L[x+1]=ie[O+I],I+=g,L[x+2]=ie[O+I],I+=g,L[x+3]=ie[O+I],x+=4}ne--}return L},M=function(o,h,a,g){const L=o[h+3],x=Math.pow(2,L-128)/255;a[g+0]=o[h+0]*x,a[g+1]=o[h+1]*x,a[g+2]=o[h+2]*x,a[g+3]=1},D=function(o,h,a,g){const L=o[h+3],x=Math.pow(2,L-128)/255;a[g+0]=Ye.toHalfFloat(Math.min(o[h+0]*x,65504)),a[g+1]=Ye.toHalfFloat(Math.min(o[h+1]*x,65504)),a[g+2]=Ye.toHalfFloat(Math.min(o[h+2]*x,65504)),a[g+3]=Ye.toHalfFloat(1)},W=new Uint8Array(r);W.pos=0;const H=G(W),Y=H.width,C=H.height,f=re(W.subarray(W.pos),Y,C);let ee,se,te;switch(this.type){case Ge:te=f.length/4;const o=new Float32Array(te*4);for(let a=0;a<te;a++)M(f,a*4,o,a*4);ee=o,se=Ge;break;case Se:te=f.length/4;const h=new Uint16Array(te*4);for(let a=0;a<te;a++)D(f,a*4,h,a*4);ee=h,se=Se;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:Y,height:C,data:ee,header:H.string,gamma:H.gamma,exposure:H.exposure,type:se}}setDataType(r){return this.type=r,this}load(r,E,e,Q){function P(c,d){switch(c.type){case Ge:case Se:"colorSpace"in c?c.colorSpace="srgb-linear":c.encoding=3e3,c.minFilter=ke,c.magFilter=ke,c.generateMipmaps=!1,c.flipY=!0;break}E&&E(c,d)}return super.load(r,P,e,Q)}}class on extends Tt{constructor(r){super(r),this.hdrLoader=new nn,this.type=Se}load(r,E,e,Q){typeof r=="string"?r=[r]:Array.isArray(r)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(r),r=E,E=e,e=Q,Q=arguments[4]);const P=new Pt;switch(P.type=this.type,P.type){case Ge:case Se:"colorSpace"in P?P.colorSpace="srgb-linear":P.encoding=3e3,P.minFilter=ke,P.magFilter=ke,P.generateMipmaps=!1;break}const c=this;let d=0;function w(V,_,k,G){new Rt(c.manager).setPath(c.path).setResponseType("arraybuffer").setWithCredentials(c.withCredentials).load(r[V],function(re){d++;const M=c.hdrLoader.parse(re);if(M){if(M.data!==void 0){const D=new St(M.data,M.width,M.height);D.type=P.type,"colorSpace"in D?D.colorSpace=P.SRGBColorSpace:D.encoding=P.encoding,D.format=P.format,D.minFilter=P.minFilter,D.magFilter=P.magFilter,D.generateMipmaps=P.generateMipmaps,P.images[V]=D}d===6&&(P.needsUpdate=!0,_&&_(P))}},k,G)}for(let V=0;V<r.length;V++)w(V,E,e,Q);return P}setDataType(r){return this.type=r,this.hdrLoader.setDataType(r),this}}const an="_earth_4tqjk_1",rn="_loader_4tqjk_15",sn="_viewport_4tqjk_43",cn="_canvas_4tqjk_65",ln="_labels_4tqjk_103",un="_label_4tqjk_103",dn="_vignette_4tqjk_163",pn="_sections_4tqjk_187",mn="_section_4tqjk_187",ge={earth:an,loader:rn,viewport:sn,canvas:cn,labels:ln,label:un,vignette:dn,sections:pn,section:mn},Ke={x:0,y:0,z:2},Ze=(p,r,E)=>p+E*(r-p),st=p=>Object.keys(p).map(r=>parseFloat(Math.round(p[r]*100)/100).toFixed(2)).join(", "),Xe=p=>!p||!p.camera?Ke:{x:p.camera[0],y:p.camera[1],z:p.camera[2]},hn=(p,r)=>{const E=(e=0)=>Math.round((e+Number.EPSILON)*100)/100;return E(p==null?void 0:p.x)===E(r==null?void 0:r.x)&&E(p==null?void 0:p.y)===E(r==null?void 0:r.y)&&E(p==null?void 0:p.z)===E(r==null?void 0:r.z)},We={stiffness:80,damping:40,mass:2,restSpeed:.001,restDelta:.001},qe={stiffness:40,damping:30,mass:2,restSpeed:.001,restDelta:.001},fn={stiffness:40,damping:30},ct=l.createContext({}),vn=({position:p=[0,0,0],scale:r=1,hideMeshes:E=[],labels:e=[],className:Q,children:P})=>{const[c,d]=l.useState(!1),[w,V]=l.useState(!1),[_,k]=l.useState(!1),[G,re]=l.useState(!1),M=l.useRef([]),D=l.useRef(),W=l.useRef(),H=l.useRef(),Y=l.useRef(),C=l.useRef(),f=l.useRef(),ee=l.useRef(),se=l.useRef(),te=l.useRef(),o=l.useRef(),h=l.useRef(),a=l.useRef(),g=gt(H),L=l.useRef(),x=l.useRef(Xe(M.current[0])),u=l.useRef([]),b=l.useRef(),T=l.useRef(),ie=l.useRef(),ne=l.useRef(),{width:q,height:Z}=bt(),ue=lt(),O=Te(0,We),I=Te(0,We),oe=Te(0,We),be=Te(0,qe),we=Te(0,qe),_e=Te(0,qe),ye=Te(0,fn),Me=l.useCallback(()=>{if(!g){cancelAnimationFrame(L.current);return}L.current=requestAnimationFrame(Me);const R=ee.current.getDelta();a.current.update(R),b.current.update(),C.current.render(Y.current,f.current),u.current.forEach(v=>{const{element:j,position:X,sprite:K}=v,F=new J(...X),A=f.current.position.distanceTo(o.current.position),z=f.current.position.distanceTo(K.position)>A;F.project(f.current),F.x=Math.round((.5+F.x/2)*window.innerWidth),F.y=Math.round((.5-F.y/2)*window.innerHeight),j.style.setProperty("--posX",Je(F.x)),j.style.setProperty("--posY",Je(F.y)),z?j.dataset.occluded=!0:j.dataset.occluded=!1})},[g]);l.useEffect(()=>{ne.current=!0;const{innerWidth:R,innerHeight:v}=window;C.current=new Mt({canvas:H.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),C.current.setPixelRatio(1),C.current.outputColorSpace=nt,C.current.toneMapping=xt,f.current=new De(54,R/v,.1,100),f.current.position.x=x.current.x,f.current.position.y=x.current.y,f.current.position.z=x.current.z,f.current.lookAt(0,0,0),O.set(f.current.position.x,!1),I.set(f.current.position.y,!1),oe.set(f.current.position.z,!1),Y.current=new vt,ee.current=new At,te.current=new Lt;const j=new jt(2236962,.05),X=new Dt(16777215,1.5);X.position.set(3,0,1);const K=[j,X];return K.forEach(F=>Y.current.add(F)),b.current=new tn(f.current,H.current),b.current.enableZoom=!1,b.current.enablePan=!1,b.current.enableDamping=!1,b.current.rotateSpeed=.5,()=>{ne.current=!1,cancelAnimationFrame(L.current),kt(K),Ot(Y.current),Ct(C.current)}},[]),l.useEffect(()=>{const R=()=>{V(!0),O.stop(),I.stop(),oe.stop()},v=()=>{O.set(f.current.position.x,!1),I.set(f.current.position.y,!1),oe.set(f.current.position.z,!1),V(!1)};return b.current.addEventListener("start",R),b.current.addEventListener("end",v),()=>{b.current.removeEventListener("start",R),b.current.removeEventListener("end",v)}},[O,I,oe]),l.useEffect(()=>{if(!c)return;const R=Ve("Chunk",o.current),v=Ve("Atmosphere",o.current),j=(m,N)=>{f.current.position[m]=N},X=O.on("change",m=>j("x",m)),K=I.on("change",m=>j("y",m)),F=oe.on("change",m=>j("z",m)),A=(m,N)=>{R.position[m]=N},de=be.on("change",m=>A("x",m)),z=we.on("change",m=>A("y",m)),U=_e.on("change",m=>A("z",m)),y=ye.on("change",m=>{v.material.opacity=m});return()=>{X(),K(),F(),de(),z(),U(),y()}},[O,I,oe,be,we,_e,c,ye]),l.useEffect(()=>{q<=ut.tablet&&(b.current.enabled=!1)},[q]),l.useEffect(()=>{if(c)return;const R=new on,v=new It(C.current);v.compileCubemapShader();const j=async()=>{const A=await zt.loadAsync(Ut);o.current=A.scene,h.current=A.animations,a.current=new Ht(o.current),a.current.timeScale=.1,o.current.traverse(async de=>{const{material:z,name:U}=de;U==="Atmosphere"&&(z.alphaMap=z.map),z&&await C.current.initTexture(z)}),o.current.position.x=p[0],o.current.position.y=p[1],o.current.position.z=p[2],o.current.scale.x=r,o.current.scale.y=r,o.current.scale.z=r},X=async()=>{const A=await R.loadAsync([Vt,Zt,Xt,Wt,qt,Kt]);A.magFilter=ke,T.current=v.fromCubemap(A),v.dispose(),await C.current.initTexture(T.current.texture)},K=async()=>{const A=await Yt.loadAsync($t);A.mapping=Bt,A.colorSpace=nt,Y.current.background=A,await C.current.initTexture(A)},F=async()=>{await Promise.all([K(),X(),j()]),o.current.traverse(({material:A})=>{A&&(A.envMap=T.current.texture,A.needsUpdate=!0)}),ne.current&&d(!0)};l.startTransition(()=>{F(),setTimeout(()=>{re(!0)},1e3)})},[c,p,r]),l.useEffect(()=>(c&&!ie.current&&(Y.current.add(o.current),ie.current=!0),c&&g&&(k(!0),Me()),()=>{cancelAnimationFrame(L.current)}),[Me,g,c]),l.useEffect(()=>{c&&(W.current.innerHTML="",u.current=e.map(R=>{const v=document.createElement("div");v.classList.add(ge.label),v.dataset.hidden=!0,v.style.setProperty("--delay",`${R.delay||0}ms`),v.textContent=R.text,W.current.appendChild(v);const j=new Nt;return j.position.set(...R.position),j.scale.set(60,60,1),{element:v,...R,sprite:j}}))},[e,c]),l.useEffect(()=>{C.current.setSize(q,Z),f.current.aspect=q/Z,f.current.updateProjectionMatrix()},[q,Z]),l.useEffect(()=>{const R=H.current,v=j=>{const{innerWidth:X,innerHeight:K}=window,F=st(f.current.position);console.info({cameraPosition:F}),se.current=new ce(j.clientX/X*2-1,-(j.clientY/K)*2+1),te.current.setFromCamera(se.current,f.current);const A=te.current.intersectObjects(Y.current.children,!0);if(A.length>0){const de=st(A[0].point);console.info({clickPosition:de})}};return()=>{R.removeEventListener("click",v)}},[]);const Oe=l.useCallback(()=>{if(!D.current)return;const{offsetTop:R}=D.current,{innerHeight:v}=window,j=window.scrollY-R;let X;const K=z=>{const U=M.current[z].meshes;o.current.traverse(y=>{const{name:m}=y,N=Ve("Chunk",o.current),$=U==null?void 0:U.includes(m),pe=E==null?void 0:E.includes(m);if($)if(m==="Atmosphere")y.visible=!0,ye.set(1);else if(m==="Chunk"){const ae=new J(-.4,.4,.4);y.visible=!0,ue?y.position.set(...ae.toArray()):(be.set(ae.x),we.set(ae.y),_e.set(ae.z))}else m==="EarthFull"&&N.visible?y.visible=!1:y.visible=!0;else if(pe&&!$)if(m==="Atmosphere")ye.set(0);else if(m==="Chunk"){const ae=new J(0,0,0);hn(ae,N.position)&&(y.visible=!1),be.set(ae.x),we.set(ae.y),_e.set(ae.z)}else m==="EarthPartial"&&N.visible?y.visible=!0:y.visible=!1})},F=z=>{const U=M.current[z].animations;ue||(h.current.forEach((y,m)=>{U.find(N=>N.includes(m.toString()))||a.current.clipAction(y).reset().stop()}),h.current.length&&M.current[z].animations&&U.forEach(y=>{const m=y.split(":"),N=h.current[Number(m[0])],$=a.current.clipAction(N);(!m[1]||m[1]!=="loop")&&($.clampWhenFinished=!0,$.loop=Gt),$.play()}))},A=z=>{u.current.forEach(y=>{y.hidden&&(y.element.dataset.hidden=!0,y.element.setAttribute("aria-hidden",!0))}),M.current[z].labels.forEach(y=>{u.current.filter(N=>N.text===y).forEach(N=>{N.element.dataset.hidden=!1,N.element.setAttribute("aria-hidden",!1)})})};requestAnimationFrame(()=>{const z=M.current.length-1,U=Math.floor(j/v),y=ot(U,0,z),m=M.current[y],N=M.current[y+1],$=Xe(m)||Ke,pe=Xe(N)||Ke,ae=(j-v*y)/v,xe=ot(ae,0,1),ve=Ze($.x,pe.x,xe),Ne=Ze($.y,pe.y,xe),Fe=Ze($.z,pe.z,xe);if(X!==$&&M.current.length&&m&&(K(y),F(y),A(y)),X=$,!w){if(ue){f.current.position.set(ve,Ne,Fe);return}O.set(ve),I.set(Ne),oe.set(Fe)}})},[O,I,oe,be,we,_e,w,E,ye,ue]);l.useEffect(()=>{const R=Ft(Oe,100);return c&&g&&window.addEventListener("scroll",R),()=>{window.removeEventListener("scroll",R)}},[Oe,g,c,ye]);const Ce=l.useCallback(R=>{M.current=[...M.current,R]},[]),Ie=l.useCallback(R=>{M.current=M.current.filter(v=>v!==R)},[]);return le.jsx(ct.Provider,{value:{registerSection:Ce,unregisterSection:Ie},children:le.jsxs("div",{className:it(ge.earth,Q),ref:D,children:[le.jsxs("div",{className:ge.viewport,children:[le.jsx("canvas",{className:ge.canvas,"data-visible":c&&_,"data-grabbing":w,ref:H}),le.jsx("div",{className:ge.labels,"aria-live":"polite",ref:W}),le.jsx("div",{className:ge.vignette})]}),le.jsx("div",{className:ge.sections,children:P}),le.jsx(dt,{unmount:!0,in:!c&&G,timeout:pt(ft.base.durationL),children:R=>le.jsx(ht,{className:ge.loader,"data-visible":R,children:le.jsx(mt,{})})})]})})},An=l.memo(({children:p,scrim:r,scrimReverse:E,className:e,camera:Q=[0,0,0],animations:P=[],meshes:c=[],labels:d=[]})=>{const{registerSection:w,unregisterSection:V}=l.useContext(ct),_=l.useRef(),k=JSON.stringify(P)+JSON.stringify(Q)+JSON.stringify(d)+JSON.stringify(c);return l.useEffect(()=>{const G={camera:Q,animations:P,meshes:c,labels:d,sectionRef:_};return w(G),()=>{V(G)}},[k,w,V]),le.jsx("div",{className:it(ge.section,e),"data-scrim":r,"data-scrim-reverse":E,ref:_,children:p})});export{vn as Earth,An as EarthSection};
